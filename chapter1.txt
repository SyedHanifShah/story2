this is chapter1 inclusive. in haniexp branch.